<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jadwal Sholat Solear</title>

<style>
body{
  margin:0;
  font-family:'Segoe UI',Tahoma,sans-serif;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}

.card{
  background:rgba(255,255,255,0.08);
  padding:26px 22px;
  border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,0.4);
  max-width:420px;
  width:92%;
  text-align:center;
}

.logo{
  width:90px;
  margin-bottom:10px;
}

.arab{
  font-size:22px;
  margin-bottom:10px;
}

h1{
  font-size:24px;
  margin-bottom:4px;
}

.lokasi{
  font-size:14px;
  opacity:0.9;
  margin-bottom:12px;
}

.jam{
  font-size:30px;
  font-weight:bold;
  margin-bottom:6px;
}

.countdown{
  font-size:14px;
  opacity:0.85;
  margin-bottom:16px;
}

/* JADWAL */
.jadwal{
  background:rgba(0,0,0,0.35);
  border-radius:12px;
  padding:12px;
}

.row{
  display:flex;
  justify-content:space-between;
  padding:8px 6px;
  border-bottom:1px solid rgba(255,255,255,0.15);
}

.row:last-child{border-bottom:none;}

.nama{font-weight:500;}
.waktu{font-weight:bold;}

.active{
  background:rgba(0,255,150,0.25);
  border-radius:8px;
}

footer{
  margin-top:14px;
  font-size:12px;
  opacity:0.75;
}
</style>
</head>

<body>

<div class="card">
  <img src="logo-masjid-v2.jpg" class="logo">

  <audio id="adzan" src="adzan.mp3"></audio>

  <div class="arab">بِسْمِ اللّٰهِ الرَّحْمٰنِ الرَّحِيْمِ</div>
  <h1>Jadwal Sholat</h1>
  <div class="lokasi">Solear – Tangerang (WIB)</div>

  <div class="jam" id="jam">00:00:00</div>
  <div class="countdown" id="countdown">Menuju sholat berikutnya…</div>

  <div class="jadwal" id="jadwal"></div>

  <footer>
    © 2026 | ags tech
  </footer>
</div>

<script>
const kotaId = 1221; // KODE KEMENAG KAB. TANGERANG
let jadwalHariIni = {};
let adzanPlayed = {};

function updateJam(){
  const now = new Date();
  const h = String(now.getHours()).padStart(2,'0');
  const m = String(now.getMinutes()).padStart(2,'0');
  const s = String(now.getSeconds()).padStart(2,'0');
  document.getElementById("jam").innerText = `${h}:${m}:${s}`;
}
setInterval(updateJam,1000);
updateJam();

// AMBIL JADWAL DARI KEMENAG
async function loadJadwal(){
  const now = new Date();
  const y = now.getFullYear();
  const m = String(now.getMonth()+1).padStart(2,'0');
  const d = String(now.getDate()).padStart(2,'0');

  const url = `https://api.myquran.com/v2/sholat/jadwal/${kotaId}/${y}/${m}/${d}`;
  const res = await fetch(url);
  const data = await res.json();

  jadwalHariIni = data.data.jadwal;
  renderJadwal();
}

function renderJadwal(){
  const list = [
    ["Subuh", jadwalHariIni.subuh],
    ["Dzuhur", jadwalHariIni.dzuhur],
    ["Ashar", jadwalHariIni.ashar],
    ["Maghrib", jadwalHariIni.maghrib],
    ["Isya", jadwalHariIni.isya]
  ];

  const now = new Date();
  let nextTime = null;

  let html = "";
  list.forEach(([nama,waktu])=>{
    const [hh,mm] = waktu.split(":");
    const t = new Date();
    t.setHours(hh,mm,0);

    let active = "";
    if(Math.abs(now - t) < 60000){
      active = "active";
      if(!adzanPlayed[nama]){
        document.getElementById("adzan").play().catch(()=>{});
        adzanPlayed[nama] = true;
      }
    }

    if(t > now && !nextTime) nextTime = t;

    html += `
      <div class="row ${active}">
        <span class="nama">${nama}</span>
        <span class="waktu">${waktu}</span>
      </div>`;
  });

  document.getElementById("jadwal").innerHTML = html;

  if(nextTime){
    const diff = nextTime - now;
    const m = Math.floor(diff/60000);
    const s = Math.floor((diff%60000)/1000);
    document.getElementById("countdown").innerText =
      `Menuju sholat berikutnya: ${m} menit ${s} detik`;
  }
}

setInterval(renderJadwal,1000);
loadJadwal();

// AKTIFKAN AUDIO SETELAH KLIK
document.addEventListener("click",()=>{
  document.getElementById("adzan").play().catch(()=>{});
});
</script>

</body>
</html>
